name: Get database
on: [push]

jobs:
  build:
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v2

    - name: Installing dependencies
      run: choco install wget grep sed

    - name: Downloading IDA pro
      uses: i3h/download-release-asset@v1.0.0
      with:
        owner: bedrock-server-mods
        repo: ida-pro-images
        tag: latest
        file: ida.zip
        token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}

    - name: Installing IDA pro
      run: .\installer.ps1

    - name: Downloading bedrock_server
      run: wget -q https://www.pastefile.com/download/phn98s -O bedrock_server
      shell: bash

    - name: Analyzing binary file
      run: \& 'C:\\Program Files\\IDA 7.2\\idat64.exe' -B bedrock_server

    - uses: actions/upload-artifact@v2
      with:
        name: database
        target: "*.i64"
