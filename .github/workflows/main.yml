name: Get database
on: [push]

jobs:
  build:
    runs-on: windows-latest
    steps:
    - name: Download IDA pro
      uses: i3h/download-release-asset@v1.0.0
      with:
        owner: bedrock-server-mods
        repo: ida-pro-images
        tag: latest
        file: ida.zip
        token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}

    - name: Download innoextract
      uses: i3h/download-release-asset@v1.0.0
      with:
        owner: dscharrer
        repo: innoextract
        tag: 1.8
        file: innoextract-1.8-windows.zip
        token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}

    - name: Unpack everything
      run: |
        7z x -sdel ida.zip
        7z x -sdel innoextract*.zip *.exe

    - name: Install IDA
      run: |
        cd '.\IDA PRO 7.2\'
        $PASSWORD=type .\install_key.txt
        ..\innoextract.exe -q -P $PASSWORD x64_idapronw_hexx64w_181105_de455c480e11ef1ec91473028f4dd175.exe
        dir
